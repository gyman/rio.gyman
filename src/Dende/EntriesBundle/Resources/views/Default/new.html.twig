{% if voucher is null %}
<div class="alert alert-error">
    <strong>Uwaga!</strong>
    <a class="close" data-dismiss="alert" href="#">&times;</a>
    Uczestnik nie posiada wykupionego karnetu!
</div>
{% elseif voucher.getAmountLeft() == 0 %}
<div class="alert alert-error">
    <strong>Uwaga!</strong>
    <a class="close" data-dismiss="alert" href="#">&times;</a>
    Uczestnik wykorzystał już wszystkie wejścia z posiadanego karnetu!
</div>
{% endif %}

{% if form.vars.errors|length > 0 %}
<div class="alert alert-error">
    <strong>Uwaga!</strong><a class="close" data-dismiss="alert" href="#">&times;</a>
    {{ form_errors(form) }}
</div>
{%endif %}


<form
    id="entranceForm"
    class="form-horizontal row-fluid"
    action="{% block action %}{{ path('_entrance_add', {"id" : member.id}) }}{% endblock action %}"
    method="{% block method %}post{% endblock method %}"
    {{ form_enctype(form) }}>

    {{ form_row(form.entryType,{"label" : "Rodzaj"}) }}
    {{ form_row(form.activity,{"label" : "Zajęcia"}) }}

    <div class="hidden">
    {{ form_rest(form) }}
    </div>

</form>

{% if currentEvents|length > 0 %}
<div class="alert">
    <strong>Trwające właśnie zajęcia:</strong>

    {% for i,event in currentEvents %}
     {{ event.getActivity().getName() }}
    ({{ event.getStartHour() }} - {{ event.getEndHour() }})
    {{ i == currentEvents|length - 1 ? "" : ", " }}
    {% endfor %}
</div>
{% endif %}

<script>
    $(function() {

        $("#addEntrance").off("click.sendForm").on("click.sendForm", function() {
            var $form = $("form#entranceForm");
            var $modal = $("div#editEntranceModal");
            $.post($form.attr("action"), $form.serialize(), function(data) {
                $modal.modal("hide");
                $.pnotify({
                    title: 'Uwaga',
                    text: 'Dodano wejście na zajęcia',
                    icon: false,
                    opacity: 0.95,
                    sticker: false,
                    history: false
                });
            }).fail(function(xhr, textStatus, errorThrown) {
                $(".modal-body", $modal).html(xhr.responseText);
            });

        });

    });
</script>